<div align="center">

# ç‚–ç‚–å“¨å…µ

**dundun-sentinel**

è½»é‡çº§ç½‘ç«™ç›‘æ§ç³»ç»Ÿ | åŸºäº Cloudflare Workers | å®Œå…¨å…è´¹ | ä¸€é”®éƒ¨ç½²

[![License](https://img.shields.io/badge/License-MIT-blue.svg)](LICENSE)
[![Cloudflare Workers](https://img.shields.io/badge/Cloudflare-Workers-orange)](https://workers.cloudflare.com/)
[![GitHub Stars](https://img.shields.io/github/stars/mciart/dundun-sentinel?style=social)](https://github.com/mciart/dundun-sentinel)

[æ¼”ç¤ºç«™ç‚¹](https://dundun-sentinel.mciart.workers.dev/) Â· [å¿«é€Ÿéƒ¨ç½²](#-å¿«é€Ÿéƒ¨ç½²) Â· [åŠŸèƒ½ä»‹ç»](#-åŠŸèƒ½ç‰¹æ€§) Â· [æœ¬åœ°å¼€å‘](#-æœ¬åœ°å¼€å‘)

---

*æ…¢æ…¢ç‚–ï¼Œç½‘ç«™ä¸"ç³Šé”…"*

</div>

---

## é¢„è§ˆæˆªå›¾

<div align="center">

| ä¸»é¡µ - æµ…è‰²æ¨¡å¼ | ä¸»é¡µ - æ·±è‰²æ¨¡å¼ |
|:---:|:---:|
| <img src="docs/1.png" alt="ä¸»é¡µæµ…è‰²æ¨¡å¼" width="400"> | <img src="docs/2.png" alt="ä¸»é¡µæ·±è‰²æ¨¡å¼" width="400"> |

| åå°ç«™ç‚¹ç®¡ç† - æµ…è‰²æ¨¡å¼ | åå°ç«™ç‚¹ç®¡ç† - æ·±è‰²æ¨¡å¼ |
|:---:|:---:|
| <img src="docs/3.png" alt="åå°ç«™ç‚¹ç®¡ç†æµ…è‰²æ¨¡å¼" width="400"> | <img src="docs/4.png" alt="åå°ç«™ç‚¹ç®¡ç†æ·±è‰²æ¨¡å¼" width="400"> |

| åå°è®¾ç½® - æµ…è‰²æ¨¡å¼ | åå°é€šçŸ¥ - æ·±è‰²æ¨¡å¼ |
|:---:|:---:|
| <img src="docs/5.png" alt="åå°è®¾ç½®æµ…è‰²æ¨¡å¼" width="400"> | <img src="docs/6.png" alt="åå°é€šçŸ¥æ·±è‰²æ¨¡å¼" width="400"> |

</div>

<details>
<summary><b>é‡è¦æ¨¡å—åŒ–æ¶æ„é‡æ„è¯´æ˜ï¼ˆç‚¹å‡»å±•å¼€ï¼‰</b></summary>

ä¸ºæå‡ç³»ç»Ÿçš„å¯æ‰©å±•æ€§ä¸å¯ç»´æŠ¤æ€§ï¼Œæœ¬é¡¹ç›®å·²å®Œæˆæ·±åº¦æ¨¡å—åŒ–é‡æ„ã€‚æ–°çš„æ¶æ„å°†æ ¸å¿ƒé€»è¾‘ã€ä¸šåŠ¡å®ç°ä¸æ¥å£å±‚è¿›è¡Œäº†æ¸…æ™°çš„è§£è€¦ï¼š

#### æ ¸å¿ƒå±‚ (Core & Utils)
- **D1 æ•°æ®åº“å­˜å‚¨ (`src/core/storage.js`)**ï¼šä½¿ç”¨ Cloudflare D1 SQL æ•°æ®åº“ï¼Œæä¾› 100,000 æ¬¡/å¤©çš„å†™å…¥é…é¢ã€‚
- **çŠ¶æ€ç®¡ç†ä¸­å¿ƒ (`src/core/state.js`)**ï¼šæ ‡å‡†åŒ–çš„çŠ¶æ€è¯»å†™æµç¨‹ï¼Œç¡®ä¿æ•°æ®ä¸€è‡´æ€§ã€‚
- **ç»Ÿè®¡å¼•æ“ (`src/core/stats.js`)**ï¼šç‹¬ç«‹çš„ç›‘æ§æ•°æ®ç»Ÿè®¡é€»è¾‘ï¼Œè§£è€¦ä¸šåŠ¡è°ƒåº¦ä¸æ•°æ®åˆ†æã€‚
- **é€šç”¨å·¥å…·åº“ (`src/utils.js`)**ï¼šæ”¶æ•›æ‰€æœ‰åŸºç¡€å·¥å…·å‡½æ•°ï¼Œæ¶ˆé™¤é‡å¤å®šä¹‰ã€‚

#### é…ç½®ä¸­å¿ƒ (Config)
- **é»˜è®¤é…ç½® (`src/config/defaults.js`)**ï¼šå“ç‰Œã€è®¤è¯ã€åˆ†ç»„ã€è®¾ç½®ã€é€šçŸ¥ã€Pushã€ç›‘æ§é»˜è®¤å€¼ã€‚
- **è¶…æ—¶é…ç½® (`src/config/timeouts.js`)**ï¼šHTTP/TCP/SMTP/DNS è¶…æ—¶ã€æ£€æµ‹é—´éš”ã€è¯ä¹¦é¢„è­¦å¤©æ•°ã€‚
- **é˜ˆå€¼é…ç½® (`src/config/thresholds.js`)**ï¼šå“åº”æ—¶é—´é˜ˆå€¼ã€çŠ¶æ€é¢œè‰²ã€æŒ‡æ ‡é¢œè‰²ã€‚

#### ä¸šåŠ¡é€»è¾‘å±‚ (Services)
- **å¤šåè®®ç›‘æ§ (`src/monitors/`)**ï¼šé‡‡ç”¨å·¥å‚æ¨¡å¼ï¼ŒåŸç”Ÿæ”¯æŒ **HTTP/HTTPS**ã€**DNS** (1.1.1.1 DoH)ã€**TCP** (Cloudflare Sockets)ã€**SMTP** åŠ **Push å¿ƒè·³**ã€‚
- **åˆ†å‘å¼é€šçŸ¥ (`src/notifications/`)**ï¼šæ ‡å‡†åŒ–çš„é€šçŸ¥æ¥å£ï¼Œä¾¿äºé›†æˆ Telegramã€Webhookã€é‚®ä»¶ç­‰å¤šç§æ¸ é“ã€‚

#### æ¥å£ä¸åˆ†å‘å±‚ (API & Routing)
- **æ§åˆ¶å™¨æ¨¡å¼ (`src/api/controllers/`)**ï¼šå°† `api.js` æ‹†åˆ†ä¸º `auth` (è®¤è¯)ã€`sites` (ç«™ç‚¹)ã€`config` (é…ç½®)ã€`dashboard` (ä»ªè¡¨ç›˜)ã€`monitor` (ç›‘æ§)ã€`push` (å¿ƒè·³) ç­‰ç‹¬ç«‹æ¨¡å—ã€‚
- **æ¸…æ™°çš„è·¯ç”±æ˜ å°„**ï¼š`src/api.js` ä»…è´Ÿè´£è¯·æ±‚åˆ†å‘ï¼Œä¸šåŠ¡é€»è¾‘å®Œå…¨ä¸‹æ²‰è‡³æ§åˆ¶å™¨ã€‚

#### å¼€å‘è€…å‹å¥½
- **å†…ç½® Mock æ¨¡å¼**ï¼šæ”¯æŒæœ¬åœ°è°ƒè¯•æ—¶æ¨¡æ‹Ÿæ•…éšœï¼ˆåœ¨ç«™ç‚¹é…ç½®ä¸­æ·»åŠ  `mock` å­—æ®µï¼‰ï¼Œæ–¹ä¾¿æµ‹è¯•å‘Šè­¦ä¸é˜²æŠ–æµç¨‹ã€‚
- **æœ¬åœ°æ¨¡æ‹Ÿç¯å¢ƒ**ï¼šä¼˜åŒ–æœ¬åœ°å¼€å‘ä½“éªŒï¼Œæ”¯æŒæœ¬åœ° D1 æ•°æ®åº“è°ƒè¯•ã€‚

</details>

## è®¡åˆ’æ›´æ–°

ä»¥ä¸‹åŠŸèƒ½æ­£åœ¨è®¡åˆ’ä¸­ï¼Œæ¬¢è¿æäº¤ Issue æˆ– PRï¼š

| æ£€æµ‹ç±»åˆ«         | å®ç°æ–¹å¼(ä¸ä¾èµ–ç¬¬ä¸‰æ–¹)        | å¤‡æ³¨                                                         | çŠ¶æ€ |
|------------------|----------------------------------|--------------------------------------------------------------|------|
| HTTP(S) å…¨ç±» | åŸç”Ÿ fetch()                     | åŒ…å«å…³é”®å­—ã€JSON è·¯å¾„ã€Header æ ¡éªŒ                         | å®Œæˆ |
| TCP Port     | cloudflare:sockets                | ç›´æ¥è¿›è¡Œ TCP ä¸‰æ¬¡æ¡æ‰‹                                       | å®Œæˆ |
| DNS          | 1.1.1.1 DoH API                   | å±äº Cloudflare è‡ªå®¶åŸç”Ÿæœï¼Œå¯è‡ªå®šä¹‰DoH                   | å®Œæˆ |
| Push/å¿ƒè·³    | Worker URL è·¯ç”±                   | è¢«åŠ¨æ¥æ”¶ä¸»æœºå¿ƒè·³ï¼Œæ”¯æŒ CPU/å†…å­˜/ç£ç›˜/å»¶è¿Ÿç­‰æŒ‡æ ‡ä¸ŠæŠ¥        | å®Œæˆ |
| MySQL/PSQL   | å®˜æ–¹é©±åŠ¨ + connect()              | ç›´æ¥ä» Worker è¿æ•°æ®åº“æ¡æ‰‹ï¼ˆåªè¦æ•°æ®åº“å…¬ç½‘å¯è¾¾ï¼‰            | è®¡åˆ’ |
| Redis        | connect() + Redis åè®®            | å¯ä»¥å®ç°ç®€å•çš„ PING/PONG æ¡æ‰‹                               | è®¡åˆ’ |
| SMTP         | connect()                         | æ¨¡æ‹Ÿ SMTP æ¡æ‰‹ï¼ˆHELO/EHLOï¼‰                                 | å®Œæˆ |
| Browser Engine | Browser Rendering                | Cloudflare è‡ªå®¶çš„æ¸²æŸ“å¼•æ“ï¼ˆéœ€åœ¨åå°å¼€å¯ï¼‰                   | è®¡åˆ’ |
| MQTT/Kafka   | connect()                         | åªè¦åœ¨ä»£ç é‡Œé›†æˆå¯¹åº”çš„ JS ç‰ˆå®¢æˆ·ç«¯åè®®åº“                    | è®¡åˆ’ |
| gRPC         | åŸç”Ÿ fetch (HTTP/2)               | Worker åŸç”Ÿæ”¯æŒ H2ï¼Œå¯åš gRPC æ¢æµ‹                          | è®¡åˆ’ |

å…¶ä»–åŠŸèƒ½ï¼š

- [ ] **SSL è¯ä¹¦æ£€æµ‹å¼€å…³** - å¯é€‰æ‹©æ˜¯å¦å¯ç”¨ SSL è¯ä¹¦æ£€æµ‹
- [ ] **å¿½ç•¥SSL é”™è¯¯å¼€å…³** - åœ¨æ£€æµ‹æ—¶å¿½ç•¥ TLS/SSL è¯ä¹¦é”™è¯¯
- [ ] **è‡ªå®šä¹‰è¯·æ±‚è¶…æ—¶** - åœ¨åå°è®¾ç½®ä¸­è‡ªå®šä¹‰è¯·æ±‚è¶…æ—¶æ—¶é—´
- [ ] **è‡ªå®šä¹‰å“åº”å»¶è¿Ÿ** - ä¸ºæ¯ä¸ªç«™ç‚¹å•ç‹¬è®¾ç½®å“åº”æ—¶é—´é˜ˆå€¼
- [ ] **çŸ­ä¿¡é€šçŸ¥æ”¯æŒ** - é›†æˆ Twilio ç­‰çŸ­ä¿¡æœåŠ¡ï¼Œå‘é€çŸ­ä¿¡é€šçŸ¥
- [ ] **é€šç”¨ Webhook æ”¯æŒ** - æ”¯æŒè‡ªå®šä¹‰ Webhookï¼Œå¯æ¥å…¥é’‰é’‰ã€é£ä¹¦ã€Telegram ç­‰
- [ ] **è®¡åˆ’ç»´æŠ¤æ¨¡å¼** - è®¾ç½®ç«™ç‚¹ç»´æŠ¤æ—¶é—´æ®µï¼Œç»´æŠ¤æœŸé—´ä¸å‘é€é€šçŸ¥
- [ ] **æ‰¹é‡å¯¼å…¥å¯¼å‡º** - ç«™ç‚¹é…ç½®çš„ JSON å¯¼å…¥å¯¼å‡ºï¼Œæ–¹ä¾¿è¿ç§»å¤‡ä»½
- [ ] **è‡ªå®šä¹‰çŠ¶æ€é¡µ** - è‡ªå®šä¹‰ Logoã€ä¸»é¢˜è‰²ã€å…¬å‘Šä¿¡æ¯
- [ ] **åŠ å…¥è‡ªå®šä¹‰æ£€æµ‹IPv4æˆ–IPv6** - å¯é€‰æ‹©ä»…æ£€æµ‹ IPv4 æˆ– IPv6 åœ°å€ï¼Œï¼ˆä½¿ç”¨ Happy Eyeballs ç®—æ³• åˆ¤æ–­ IP åè®®ï¼‰
- [ ] **åŠ å…¥æ›´å¤šè‡ªå®šä¹‰æ¡ä»¶åˆ¤å®š** - æ¯”å¦‚é€šè¿‡æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…å“åº”å†…å®¹
- [x] **åŠ å…¥è‡ªå®šä¹‰åŸŸåè§£æDOH** - æ”¯æŒè‡ªå®šä¹‰ DNS-over-HTTPS è§£ææœåŠ¡ï¼ˆCloudflareã€Googleã€Quad9ã€é˜¿é‡ŒDNSã€è…¾è®¯DNSPodï¼‰
- [x] **åŠ å…¥åè½¬æ¨¡å¼** - åè½¬ç›‘æ§çŠ¶æ€ã€‚å¦‚æœæœåŠ¡å¯è®¿é—®ï¼Œåˆ™è®¤ä¸ºæ˜¯æ•…éšœ

å·²å®Œæˆï¼š
- [x] **åŠ å…¥ä¸»æœºæ·±åº¦æ£€æµ‹æ¿å—** - åŸºäºå¿ƒè·³ç›‘æ§å¯¹ä¸»æœºè¿›è¡Œè¢«åŠ¨æ¢æµ‹ï¼ˆPush æ¨¡å¼ï¼‰

---

## å¿«é€Ÿéƒ¨ç½²

æ•´ä¸ªè¿‡ç¨‹çº¦ **5 åˆ†é’Ÿ**ï¼Œæ— éœ€ç¼–ç¨‹çŸ¥è¯†ã€‚

### ç¬¬ä¸€æ­¥ï¼šFork é¡¹ç›®

1. æ‰“å¼€ [dundun-sentinel](https://github.com/mciart/dundun-sentinel)
2. ç‚¹å‡»å³ä¸Šè§’ **Fork** æŒ‰é’®
3. ç‚¹å‡» **Create fork** å®Œæˆ

### ç¬¬äºŒæ­¥ï¼šè·å– Cloudflare API Token

1. ç™»å½• [Cloudflare Dashboard](https://dash.cloudflare.com)
2. ç‚¹å‡»å³ä¸Šè§’å¤´åƒ â†’ **é…ç½®æ–‡ä»¶** â†’ **API ä»¤ç‰Œ**
3. ç‚¹å‡» **åˆ›å»ºä»¤ç‰Œ**
4. ç‚¹å‡»æœ€åº•éƒ¨çš„ **åˆ›å»ºè‡ªå®šä¹‰ä»¤ç‰Œ** â†’ **å¼€å§‹ä½¿ç”¨**
5. **åç§°**: å¡«å†™ `ç‚–ç‚–å“¨å…µ`
6. **æƒé™** (æƒé™é…ç½® - é‡è¦ï¼):
   - `è´¦æˆ·` - `Workers è„šæœ¬` - `ç¼–è¾‘`
   - `è´¦æˆ·` - `D1` - `ç¼–è¾‘`
   - `è´¦æˆ·` - `å¸æˆ·è®¾ç½®` - `ç¼–è¾‘`
   - `åŒºåŸŸ` - `Workers è·¯ç”±` - `ç¼–è¾‘`
7. **è´¦æˆ·èµ„æº**: é€‰æ‹© `åŒ…æ‹¬` - `æ‰€æœ‰è´¦æˆ·`
8. **åŒºåŸŸèµ„æº**: é€‰æ‹© `åŒ…æ‹¬` - `æ‰€æœ‰åŒºåŸŸ`
9. ç‚¹å‡» **ç»§ç»­ä»¥æ˜¾ç¤ºæ‘˜è¦** â†’ **åˆ›å»ºä»¤ç‰Œ**
10. **å¤åˆ¶ Token**ï¼ˆåªæ˜¾ç¤ºä¸€æ¬¡ï¼ï¼‰

### ç¬¬ä¸‰æ­¥ï¼šåˆ›å»º D1 æ•°æ®åº“

âš ï¸ **é‡è¦**ï¼šé¦–æ¬¡éƒ¨ç½²å‰éœ€è¦æ‰‹åŠ¨åˆ›å»º D1 æ•°æ®åº“ï¼

1. ç™»å½• [Cloudflare Dashboard](https://dash.cloudflare.com)
2. è¿›å…¥ **Workers & Pages** â†’ **D1 SQL Database**
3. ç‚¹å‡» **Create** æŒ‰é’®
4. æ•°æ®åº“åç§°å¡«å†™ï¼š`dundun-sentinel-db`
5. ç‚¹å‡» **Create** å®Œæˆåˆ›å»º
6. **å¤åˆ¶åˆ›å»ºåæ˜¾ç¤ºçš„ Database ID**ï¼ˆç±»ä¼¼ `xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx`ï¼‰

### ç¬¬å››æ­¥ï¼šé…ç½® GitHub Secrets

æ‰“å¼€ä½  Fork çš„é¡¹ç›® â†’ **Settings** â†’ **Secrets and variables** â†’ **Actions**

ç‚¹å‡» **New repository secret**ï¼Œæ·»åŠ ä»¥ä¸‹å¯†é’¥ï¼š

| Name | Value | è¯´æ˜ |
|------|-------|------|
| `CLOUDFLARE_API_TOKEN` | ä½ çš„ API Token | **å¿…å¡«** |
| `D1_DATABASE_ID` | ä½ çš„ D1 æ•°æ®åº“ ID | **å¿…å¡«**ï¼ˆä¸Šä¸€æ­¥å¤åˆ¶çš„ï¼‰ |

> ğŸ”’ **å®‰å…¨å»ºè®®**ï¼šéƒ¨ç½²æˆåŠŸåï¼Œè¯·ç«‹å³ç™»å½•åå°ä¿®æ”¹é»˜è®¤å¯†ç å’Œåå°è·¯å¾„ã€‚åœ¨åå°ä¿®æ”¹çš„è®¾ç½®ä¸ä¼šè¢«åç»­æ›´æ–°éƒ¨ç½²è¦†ç›–ã€‚

### ç¬¬äº”æ­¥ï¼šè¿è¡Œéƒ¨ç½²

1. è¿›å…¥é¡¹ç›® â†’ **Actions** æ ‡ç­¾
2. å¦‚æœ‰æç¤ºï¼Œç‚¹å‡» **I understand my workflows, go ahead and enable them**
3. å·¦ä¾§é€‰æ‹© **Deploy to Cloudflare Workers**
4. ç‚¹å‡» **Run workflow** â†’ å†ç‚¹å‡»ç»¿è‰² **Run workflow**
5. ç­‰å¾…å®Œæˆï¼Œçœ‹åˆ°ç»¿è‰²å‹¾ âœ… å³éƒ¨ç½²æˆåŠŸ

### ç¬¬äº”æ­¥ï¼šè®¿é—®ç½‘ç«™

1. ç™»å½• [Cloudflare Dashboard](https://dash.cloudflare.com)
2. è¿›å…¥ **Workers & Pages**
3. æ‰¾åˆ° **dundun-sentinel** é¡¹ç›®
4. ç‚¹å‡»è®¿é—®åœ°å€å³å¯

**é»˜è®¤åå°åœ°å€ï¼š** `ä½ çš„åŸŸå/admin`  
**é»˜è®¤å¯†ç ï¼š** `admin`

---

## æ›´æ–°ä¸é‡æ–°éƒ¨ç½²

### åŒæ­¥æœ€æ–°ç‰ˆæœ¬

Fork é¡¹ç›®åï¼Œå¦‚æœåŸé¡¹ç›®æœ‰æ›´æ–°ï¼Œä½ å¯ä»¥åŒæ­¥æœ€æ–°ä»£ç ï¼š

1. æ‰“å¼€ä½  Fork çš„é¡¹ç›®é¡µé¢
2. ç‚¹å‡»ä»£ç åŒºåŸŸä¸Šæ–¹çš„ **Sync fork** æŒ‰é’®
3. ç‚¹å‡» **Update branch** åŒæ­¥æœ€æ–°ä»£ç 
4. åŒæ­¥åä¼šè‡ªåŠ¨è§¦å‘ GitHub Actions é‡æ–°éƒ¨ç½²

### é‡æ–°éƒ¨ç½²

å¦‚æœä¿®æ”¹äº† GitHub Secrets é…ç½®ï¼ˆå¦‚å¯†ç ã€åå°è·¯å¾„ç­‰ï¼‰ï¼Œéœ€è¦æ‰‹åŠ¨è§¦å‘é‡æ–°éƒ¨ç½²ï¼š

1. è¿›å…¥é¡¹ç›® â†’ **Actions** æ ‡ç­¾
2. å·¦ä¾§é€‰æ‹© **Deploy to Cloudflare Workers**
3. ç‚¹å‡» **Run workflow** ä¸‹æ‹‰èœå•
4. é€‰æ‹©åˆ†æ”¯ï¼ˆé»˜è®¤ main æˆ– masterï¼‰
5. ç‚¹å‡»ç»¿è‰² **Run workflow** æŒ‰é’®
6. ç­‰å¾…éƒ¨ç½²å®Œæˆï¼Œæ–°é…ç½®å³ç”Ÿæ•ˆ

---

## è‡ªå®šä¹‰åŸŸåé…ç½®

Cloudflare Workers æ”¯æŒå¤šç§åŸŸåç»‘å®šæ–¹å¼ï¼š

### æ–¹å¼ä¸€ï¼šCustom Domainsï¼ˆæ¨èï¼‰

æœ€ç®€å•çš„æ–¹å¼ï¼Œé€‚åˆç»‘å®šç‹¬ç«‹åŸŸåæˆ–å­åŸŸåï¼š

1. ç™»å½• [Cloudflare Dashboard](https://dash.cloudflare.com)
2. è¿›å…¥ **Workers & Pages** â†’ æ‰¾åˆ° **dundun-sentinel** é¡¹ç›®
3. ç‚¹å‡» **Settings** â†’ **Domains & Routes**
4. ç‚¹å‡» **Add** â†’ **Custom Domain**
5. è¾“å…¥åŸŸåï¼ˆå¦‚ `status.example.com`ï¼‰
6. ç‚¹å‡» **Add Custom Domain**
7. Cloudflare ä¼šè‡ªåŠ¨é…ç½® DNS è®°å½•

> æ³¨æ„ï¼šåŸŸåå¿…é¡»å·²æ·»åŠ åˆ°ä½ çš„ Cloudflare è´¦æˆ·ä¸­

### æ–¹å¼äºŒï¼šRoutesï¼ˆè·¯ç”±è§„åˆ™ï¼‰

é€‚åˆæ›´çµæ´»çš„è·¯å¾„åŒ¹é…ï¼š

1. è¿›å…¥ **Workers & Pages** â†’ **dundun-sentinel** é¡¹ç›®
2. ç‚¹å‡» **Settings** â†’ **Domains & Routes**
3. ç‚¹å‡» **Add** â†’ **Route**
4. é€‰æ‹© Zoneï¼ˆä½ çš„åŸŸåï¼‰
5. è¾“å…¥è·¯ç”±è§„åˆ™ï¼Œä¾‹å¦‚ï¼š
   - `status.example.com/*` - åŒ¹é…å­åŸŸåæ‰€æœ‰è·¯å¾„
   - `example.com/status/*` - åŒ¹é…ä¸»åŸŸåçš„ç‰¹å®šè·¯å¾„
6. ç‚¹å‡» **Add Route**

### æ–¹å¼ä¸‰ï¼šworkers.dev å­åŸŸå

æ— éœ€é…ç½®ï¼Œéƒ¨ç½²åè‡ªåŠ¨è·å¾—ï¼š

`dundun-sentinel.<ä½ çš„è´¦æˆ·>.workers.dev`

å¯åœ¨ **Settings** â†’ **Domains & Routes** ä¸­æŸ¥çœ‹æˆ–ç¦ç”¨ã€‚

---

## ä½¿ç”¨è¯´æ˜

### æ·»åŠ ç›‘æ§ç«™ç‚¹

1. ç™»å½•åå°ï¼ˆé»˜è®¤å¯†ç  `admin`ï¼‰
2. ç‚¹å‡» **æ·»åŠ ç«™ç‚¹**
3. å¡«å†™åç§°å’Œ URL
4. å¯é€‰ï¼šé…ç½®é«˜çº§é€‰é¡¹ï¼ˆè¯·æ±‚æ–¹å¼ã€è¯·æ±‚å¤´ç­‰ï¼‰
5. ä¿å­˜

### é€šçŸ¥è®¾ç½®

1. åˆ‡æ¢åˆ° **é€šçŸ¥è®¾ç½®** æ ‡ç­¾
2. å¼€å¯é€šçŸ¥ â†’ é…ç½®ä¼ä¸šå¾®ä¿¡ Webhook æˆ– Resend é‚®ä»¶
3. ç‚¹å‡» **å‘é€æµ‹è¯•** éªŒè¯

### ä¿®æ”¹å¯†ç /åå°è·¯å¾„

ç™»å½•åå° â†’ åˆ‡æ¢åˆ° **åå°è®¾ç½®** æ ‡ç­¾ â†’ ä¿®æ”¹å¯†ç æˆ–åå°è·¯å¾„

> ğŸ’¡ åœ¨åå°ä¿®æ”¹çš„è®¾ç½®ä¼šå­˜å‚¨åˆ° D1 æ•°æ®åº“ï¼Œåç»­æ›´æ–°éƒ¨ç½²æ—¶ä¸ä¼šè¢«è¦†ç›–ã€‚

---

## æœ¬åœ°å¼€å‘

### ç¯å¢ƒè¦æ±‚

- Node.js 18+
- npm æˆ– pnpm

### å¿«é€Ÿå¯åŠ¨

```bash
# å…‹éš†é¡¹ç›®
git clone https://github.com/mciart/dundun-sentinel.git
cd dundun-sentinel

# å®‰è£…ä¾èµ–
npm install
cd frontend && npm install && cd ..

# æ„å»ºå‰ç«¯å¹¶å¯åŠ¨å¼€å‘æœåŠ¡å™¨
npm run dev
```

è®¿é—®ï¼š`http://localhost:8787`

### å¸¸ç”¨å‘½ä»¤

| å‘½ä»¤ | è¯´æ˜ |
|------|------|
| `npm run dev` | æœ¬åœ°å¼€å‘ï¼ˆæ„å»ºå‰ç«¯ + å¯åŠ¨æœåŠ¡ï¼‰ |
| `npm run dev:frontend` | ä»…å¯åŠ¨å‰ç«¯çƒ­é‡è½½ |
| `npm run build` | æ„å»ºå‰ç«¯ |
| `npm run deploy` | æ‰‹åŠ¨éƒ¨ç½²åˆ° Cloudflare |
| `npm run tail` | æŸ¥çœ‹çº¿ä¸Šæ—¥å¿— |

### é¡¹ç›®ç»“æ„ï¼ˆå·²æ¨¡å—åŒ–ï¼‰

```
dundun-sentinel/
â”œâ”€â”€ src/                          # Worker æºä»£ç ï¼ˆæ¨¡å—åŒ–ï¼‰
â”‚   â”œâ”€â”€ index.js                  # ä¸»å…¥å£
â”‚   â”œâ”€â”€ api.js                    # API è·¯ç”±åˆ†å‘
â”‚   â”œâ”€â”€ monitor.js                # ç›‘æ§è°ƒåº¦å™¨
â”‚   â”œâ”€â”€ utils.js                  # é€šç”¨å·¥å…·å‡½æ•°
â”‚   â”œâ”€â”€ config/                   # é…ç½®ä¸­å¿ƒ
â”‚   â”‚   â”œâ”€â”€ index.js              # é…ç½®å¯¼å‡º
â”‚   â”‚   â”œâ”€â”€ defaults.js           # é»˜è®¤é…ç½®ï¼ˆå“ç‰Œã€è®¤è¯ã€åˆ†ç»„ç­‰ï¼‰
â”‚   â”‚   â”œâ”€â”€ timeouts.js           # è¶…æ—¶é…ç½®
â”‚   â”‚   â””â”€â”€ thresholds.js         # é˜ˆå€¼é…ç½®
â”‚   â”œâ”€â”€ core/                     # æ ¸å¿ƒå±‚
â”‚   â”‚   â”œâ”€â”€ storage.js            # D1 æ•°æ®åº“å­˜å‚¨å±‚
â”‚   â”‚   â”œâ”€â”€ state.js              # çŠ¶æ€ç®¡ç†ä¸­å¿ƒ
â”‚   â”‚   â””â”€â”€ stats.js              # ç»Ÿè®¡å¼•æ“
â”‚   â”œâ”€â”€ monitors/                 # å„åè®®ç›‘æ§å®ç°
â”‚   â”‚   â”œâ”€â”€ index.js              # ç›‘æ§å·¥å‚
â”‚   â”‚   â”œâ”€â”€ http.js               # HTTP/HTTPS ç›‘æ§
â”‚   â”‚   â”œâ”€â”€ dns.js                # DNS ç›‘æ§
â”‚   â”‚   â”œâ”€â”€ tcp.js                # TCP ç«¯å£ç›‘æ§
â”‚   â”‚   â”œâ”€â”€ smtp.js               # SMTP ç›‘æ§
â”‚   â”‚   â””â”€â”€ push.js               # Push å¿ƒè·³ç›‘æ§
â”‚   â”œâ”€â”€ notifications/            # é€šçŸ¥æ¸ é“å®ç°
â”‚   â”‚   â”œâ”€â”€ index.js              # é€šçŸ¥åˆ†å‘å™¨
â”‚   â”‚   â”œâ”€â”€ wecom.js              # ä¼ä¸šå¾®ä¿¡é€šçŸ¥
â”‚   â”‚   â””â”€â”€ email.js              # é‚®ä»¶é€šçŸ¥
â”‚   â””â”€â”€ api/                      # API æ§åˆ¶å™¨
â”‚       â””â”€â”€ controllers/
â”‚           â”œâ”€â”€ auth.js           # è®¤è¯æ§åˆ¶å™¨
â”‚           â”œâ”€â”€ sites.js          # ç«™ç‚¹ç®¡ç†
â”‚           â”œâ”€â”€ config.js         # é…ç½®ç®¡ç†
â”‚           â”œâ”€â”€ dashboard.js      # ä»ªè¡¨ç›˜æ•°æ®
â”‚           â”œâ”€â”€ monitor.js        # ç›‘æ§æ“ä½œ
â”‚           â””â”€â”€ push.js           # Push å¿ƒè·³ API
â”œâ”€â”€ frontend/                      # å‰ç«¯é¡¹ç›® (React + Vite)
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ components/           # React ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ pages/                # é¡µé¢ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ context/              # React Context
â”‚   â”‚   â”œâ”€â”€ hooks/                # è‡ªå®šä¹‰ Hooks
â”‚   â”‚   â”œâ”€â”€ utils/                # å‰ç«¯å·¥å…·å‡½æ•°
â”‚   â”‚   â””â”€â”€ config.js             # å‰ç«¯é…ç½®
â”‚   â”œâ”€â”€ public/                   # é™æ€èµ„æº
â”‚   â””â”€â”€ dist/                     # æ„å»ºäº§ç‰©
â”œâ”€â”€ docs/                          # æ–‡æ¡£ä¸æˆªå›¾
â”œâ”€â”€ .github/workflows/
â”‚   â””â”€â”€ deploy.yml                 # è‡ªåŠ¨éƒ¨ç½²å·¥ä½œæµ
â”œâ”€â”€ wrangler.toml                  # Cloudflare Worker é…ç½®
â”œâ”€â”€ package.json
â””â”€â”€ README.md
```

---

## å¸¸è§é—®é¢˜

<details>
<summary><b>éƒ¨ç½²å¤±è´¥æ€ä¹ˆåŠï¼Ÿ</b></summary>

1. æ£€æŸ¥ GitHub Secrets æ˜¯å¦æ­£ç¡®é…ç½®ï¼ˆä¸‰ä¸ªéƒ½è¦å¡«ï¼‰
2. æ£€æŸ¥ API Token æƒé™æ˜¯å¦å®Œæ•´
3. æŸ¥çœ‹ Actions æ—¥å¿—å®šä½é”™è¯¯

</details>

<details>
<summary><b>ç›‘æ§é—´éš”æ˜¯å¤šä¹…ï¼Ÿ</b></summary>

æ¯ **1 åˆ†é’Ÿ**æ£€æµ‹ä¸€æ¬¡æ‰€æœ‰ç«™ç‚¹ã€‚

</details>

<details>
<summary><b>æ•°æ®ä¿ç•™å¤šä¹…ï¼Ÿ</b></summary>

é»˜è®¤ä¿ç•™ 30 å¤©å†å²æ•°æ®ã€‚

</details>

<details>
<summary><b>æœ‰ä½¿ç”¨é™åˆ¶å—ï¼Ÿ</b></summary>

Cloudflare Workers å…è´¹ç‰ˆæ¯å¤© 10 ä¸‡æ¬¡è¯·æ±‚ï¼Œä¸ªäººä½¿ç”¨å®Œå…¨å¤Ÿç”¨ã€‚

</details>

<details>
<summary><b>å¦‚ä½•ç»‘å®šè‡ªå®šä¹‰åŸŸåï¼Ÿ</b></summary>

è¯·å‚è€ƒä¸Šæ–¹ [è‡ªå®šä¹‰åŸŸåé…ç½®](#-è‡ªå®šä¹‰åŸŸåé…ç½®) ç« èŠ‚ã€‚

</details>

---

## æŠ€æœ¯æ ˆ

| ç±»å‹ | æŠ€æœ¯ |
|------|------|
| å‰ç«¯ | React + Vite + TailwindCSS |
| åç«¯ | Cloudflare Workers |
| æ•°æ®åº“ | Cloudflare D1 (SQLite) |
| éƒ¨ç½² | GitHub Actions + Cloudflare |

---

## ç›‘æ§è§„åˆ™ä¸ç¼“å­˜æœºåˆ¶

### æ£€æµ‹å‘¨æœŸ

| ç›‘æ§ç±»å‹ | æ£€æµ‹æ–¹å¼ | æ£€æµ‹é¢‘ç‡ | è¯´æ˜ |
|----------|----------|----------|------|
| HTTP/HTTPS | Cron ä¸»åŠ¨æ£€æµ‹ | æ¯ 1 åˆ†é’Ÿ | Cloudflare Workers å®šæ—¶ä»»åŠ¡ |
| DNS | Cron ä¸»åŠ¨æ£€æµ‹ | æ¯ 1 åˆ†é’Ÿ | é€šè¿‡ 1.1.1.1 DoH API |
| TCP | Cron ä¸»åŠ¨æ£€æµ‹ | æ¯ 1 åˆ†é’Ÿ | é€šè¿‡ Cloudflare Sockets |
| Push å¿ƒè·³ | è¢«åŠ¨æ¥æ”¶ | å®æ—¶ | ä¸»æœºä¸»åŠ¨ä¸ŠæŠ¥ |
| SSL è¯ä¹¦ | Cron æ£€æµ‹ | æ¯å°æ—¶ | è¯ä¹¦å˜åŒ–æ…¢ï¼Œæ— éœ€é¢‘ç¹æ£€æµ‹ |

### D1 æ•°æ®åº“æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                            æ•°æ®æµå‘                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ Cron    â”‚â”€â”€â”€â–¶â”‚ æ£€æµ‹ç«™ç‚¹çŠ¶æ€   â”‚â”€â”€â”€â–¶â”‚   D1 æ•°æ®åº“       â”‚    â”‚
â”‚  â”‚(æ¯1åˆ†é’Ÿ) â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚  ï¼ˆå®æ—¶å†™å…¥ï¼‰      â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                              â”‚              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚              â”‚
â”‚  â”‚ Push    â”‚â”€â”€â”€â–¶â”‚ æ¥æ”¶å¿ƒè·³æ•°æ®   â”‚â”€â”€â”€â–¶  D1 æ•°æ®åº“              â”‚
â”‚  â”‚  (å®æ—¶ï¼‰ â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    ï¼ˆå®æ—¶å†™å…¥ï¼‰              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                 â”‚              â”‚
â”‚                                              â–¼              â”‚
â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚                    â”‚        å‰ç«¯ API è¯·æ±‚              â”‚     â”‚
â”‚                    â”‚      (ä» D1 æ•°æ®åº“è¯»å–)            â”‚     â”‚
â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### D1 æ•°æ®åº“ç‰¹ç‚¹

| ç‰¹æ€§ | è¯´æ˜ |
|------|------|
| **å®æ—¶æŒä¹…åŒ–** | æ‰€æœ‰æ•°æ®ç«‹å³å†™å…¥æ•°æ®åº“ï¼Œæ— æ•°æ®ä¸¢å¤±é£é™© |
| **é«˜å†™å…¥é…é¢** | æ¯å¤© 100,000 æ¬¡å†™å…¥ï¼ˆå…è´¹ç‰ˆï¼‰ï¼Œæ˜¯ KV çš„ 100 å€ |
| **SQL æŸ¥è¯¢** | æ”¯æŒå¤æ‚æŸ¥è¯¢ï¼Œä¾¿äºæ•°æ®åˆ†æå’Œç»Ÿè®¡ |
| **äº‹åŠ¡æ”¯æŒ** | æ‰¹é‡æ“ä½œä¿è¯æ•°æ®ä¸€è‡´æ€§ |

### Push å¿ƒè·³æ¨¡å¼

Push å¿ƒè·³æ”¯æŒä¸ŠæŠ¥ä»¥ä¸‹å­—æ®µï¼š

```bash
# ç®€å•å¿ƒè·³ï¼ˆä»…åœ¨çº¿çŠ¶æ€ï¼‰
curl -X POST "https://your-worker.workers.dev/api/push/YOUR_TOKEN"

# å¸¦ç³»ç»ŸæŒ‡æ ‡çš„å¿ƒè·³
curl -X POST "https://your-worker.workers.dev/api/push/YOUR_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "cpu": 25.5,
    "memory": 60.2,
    "disk": 45.0,
    "load": 1.5,
    "uptime": 86400,
    "temperature": 55,
    "latency": 15,
    "network": {"rx": 1024, "tx": 512},
    "custom": {
      "gpu": { "value": 45, "label": "GPU", "unit": "%", "icon": "Gauge", "showHistory": true },
      "connections": { "value": 128, "label": "è¿æ¥æ•°", "icon": "Users" }
    }
  }'
```

#### åŸºç¡€å­—æ®µ

| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| `cpu` | number | CPU ä½¿ç”¨ç‡ (%) |
| `memory` / `mem` / `ram` | number | å†…å­˜ä½¿ç”¨ç‡ (%) |
| `disk` | number | ç£ç›˜ä½¿ç”¨ç‡ (%) |
| `load` | number | ç³»ç»Ÿè´Ÿè½½ |
| `uptime` | number | è¿è¡Œæ—¶é—´ï¼ˆç§’ï¼‰ |
| `temperature` / `temp` | number | æ¸©åº¦ (Â°C) |
| `latency` | number | å»¶è¿Ÿ/å“åº”æ—¶é—´ (ms) |
| `network` | object | ç½‘ç»œæµé‡ä¿¡æ¯ |
| `custom` | object | è‡ªå®šä¹‰æ•°æ® |

#### è‡ªå®šä¹‰å­—æ®µï¼ˆcustomï¼‰

`custom` å­—æ®µæ”¯æŒä»»æ„è‡ªå®šä¹‰æŒ‡æ ‡ï¼Œæ”¯æŒç®€å•æ•°å€¼æˆ–å®Œæ•´å¯¹è±¡æ ¼å¼ï¼š

```json
{
  "custom": {
    "gpu": { 
      "value": 45, 
      "label": "GPU", 
      "unit": "%", 
      "icon": "Gauge",
      "showHistory": true 
    },
    "connections": { 
      "value": 128, 
      "label": "è¿æ¥æ•°", 
      "icon": "Users" 
    },
    "queue_size": 42
  }
}
```

| å±æ€§ | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|------|------|
| `value` | number | âœ… | æ•°å€¼ |
| `label` | string | âŒ | æ˜¾ç¤ºåç§° |
| `unit` | string | âŒ | å•ä½ï¼Œå¦‚ `%`, `MB`, `Â°C` |
| `icon` | string | âŒ | [Lucide å›¾æ ‡](https://lucide.dev/icons/)åç§°ï¼ˆPascalCaseï¼‰ |
| `color` | string | âŒ | å›¾è¡¨é¢œè‰²ï¼Œå¦‚ `#10b981` |
| `showHistory` | boolean | âŒ | æ˜¯å¦æ˜¾ç¤ºå†å²èµ°åŠ¿ï¼Œé»˜è®¤ true |

> ğŸ“– å®Œæ•´æ–‡æ¡£è¯·å‚è€ƒ [Push å¿ƒè·³ç›‘æ§ä½¿ç”¨æŒ‡å—](docs/push-monitor-guide.md)

### D1 é…é¢è¯´æ˜

Cloudflare D1 å…è´¹ç‰ˆæ¯å¤© **100,000 æ¬¡å†™å…¥**ï¼Œç›¸æ¯” KV çš„ 1,000 æ¬¡æå‡äº† 100 å€ã€‚

| ç›‘æ§ç«™ç‚¹æ•° | æ¯åˆ†é’Ÿæ£€æµ‹ | ä¼°ç®—æ¯æ—¥å†™å…¥ | é…é¢å ç”¨ |
|-----------|-----------|-------------|----------|
| 10 ä¸ªç«™ç‚¹ | 10 æ¬¡ | ~14,400 æ¬¡ | 14.4% |
| 30 ä¸ªç«™ç‚¹ | 30 æ¬¡ | ~43,200 æ¬¡ | 43.2% |
| 50 ä¸ªç«™ç‚¹ | 50 æ¬¡ | ~72,000 æ¬¡ | 72% |
| 60 ä¸ªç«™ç‚¹ | 60 æ¬¡ | ~86,400 æ¬¡ | 86.4% |

> **æç¤º**ï¼š1 åˆ†é’Ÿæ£€æµ‹é—´éš”ä¸‹ï¼Œå…è´¹ç‰ˆå¯æ”¯æŒçº¦ 60 ä¸ªç«™ç‚¹ã€‚å¦‚éœ€ç›‘æ§æ›´å¤šç«™ç‚¹ï¼Œå¯è€ƒè™‘å‡çº§åˆ°ä»˜è´¹ç‰ˆã€‚

---

## å¼€æºåè®®

æœ¬é¡¹ç›®åŸºäº [MIT](LICENSE) åè®®å¼€æºã€‚

---

<div align="center">

### â­ å¦‚æœè§‰å¾—é¡¹ç›®ä¸é”™ï¼Œæ¬¢è¿ç‚¹ä¸ª Star æ”¯æŒä¸€ä¸‹ï¼

</div>
